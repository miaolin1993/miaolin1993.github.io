3:I[1381,[],""]
5:I[5735,[],""]
6:I[9221,["827","static/chunks/827-f2365f9a8ea21fbf.js","885","static/chunks/885-25b99fe0d32ebdc3.js","998","static/chunks/app/docs/layout-5b1b070469058ebb.js"],""]
7:I[6943,["185","static/chunks/app/layout-76f60eb77e85b93c.js"],"ThemeProvider"]
4:["slug","tech/server","oc"]
0:["_bbFlVulI6-FA8NXql8dB",[[["",{"children":["docs",{"children":[["slug","tech/server","oc"],{"children":["__PAGE__?{\"slug\":[\"tech\",\"server\"]}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["docs",{"children":[["slug","tech/server","oc"],{"children":["__PAGE__",{},["$L1","$L2",null]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","docs","children","$4","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","$L6",null,{"children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","docs","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],"params":{}}],null]]},[null,["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_d65c78 min-h-screen bg-white dark:bg-dark-bg text-gray-900 dark:text-dark-text-primary antialiased transition-colors duration-200","children":["$","$L7",null,{"attribute":"class","defaultTheme":"system","enableSystem":true,"children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"styles":null}]}]}]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/72837339fd43c4ad.css","precedence":"next","crossOrigin":""}]],"$L8"]]]]
8:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"炳译的博客"}],["$","meta","3",{"name":"description","content":"Generated by create next app"}],["$","link","4",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]
1:null
2:["$","div",null,{"className":"container mx-auto px-4 py-8 sm:py-12","children":["$","div",null,{"className":"max-w-3xl mx-auto","children":[["$","h1",null,{"className":"text-2xl sm:text-4xl font-bold mb-4 text-gray-900 dark:text-gray-100","children":"服务端渲染"}],null,["$","div",null,{"className":"prose prose-slate dark:prose-invert max-w-none prose-sm sm:prose-base lg:prose-lg","children":"$L9"}]]}]}]
9:[["$","h2",null,{"id":"与客户端渲染区别","children":"与客户端渲染区别"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":"渲染时机不同"}],"\n"]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"服务端渲染简称SSR，是将各种资源在后端处理完成后，返回完整的html给前端，直接渲染"}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"客户端渲染简称CSR，html页面是空壳子，内容需要通过浏览器在前端来渲染，并通过脚本方式插入html中"}],"\n"]}],"\n"]}],"\n",["$","ol",null,{"start":"2","children":["\n",["$","li",null,{"children":"加载速度区别大"}],"\n"]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"服务端渲染因为是提前渲染好了页面，所以加载速度是非常快的"}],"\n",["$","li",null,{"children":"客户端渲染因为要在前端执行渲染，就会出现加载慢、性能差等问题"}],"\n"]}],"\n",["$","ol",null,{"start":"3","children":["\n",["$","li",null,{"children":"网页内容获取不同"}],"\n"]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"服务端因为提前都处理好了，一些SEO内容，或是有需要抓取页面数据等诉求，可以直接获取到"}],"\n",["$","li",null,{"children":"客户端渲染则因为脚本生成的原因，导致无法SEO，而且无法抓取页面内容"}],"\n"]}],"\n",["$","h2",null,{"id":"优势与不足","children":"优势与不足"}],"\n",["$","p",null,{"children":"基于上面说的区别，可以看出服务端渲染的优势："}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"提升首屏加载速度"}],"\n",["$","li",null,{"children":"SEO优化"}],"\n",["$","li",null,{"children":"共享链接时显示预览（因为内容都在html上面所以可以显示预览）"}],"\n"]}],"\n",["$","p",null,{"children":"当然服务端渲染也不是万能的，也会有一些不足的地方："}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"开发复杂度增加"}],"\n",["$","li",null,{"children":"服务器压力增大（通过缓存）"}],"\n",["$","li",null,{"children":"状态管理复杂，前端和后端都需要维护状态"}],"\n"]}],"\n",["$","p",null,{"children":"同时呢，有些内容是必须在客户端渲染的，比如："}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"canvas"}],"\n",["$","li",null,{"children":"事件绑定"}],"\n",["$","li",null,{"children":"层叠样式表的解析"}],"\n"]}],"\n",["$","p",null,{"children":"这样又会增加一些难度，于是又有了很多综合性的方案，比如前后端同构，混合渲染等"}],"\n",["$","h2",null,{"id":"原理和表现形式","children":"原理和表现形式"}],"\n",["$","p",null,{"children":"最早接触服务端渲染，那会还没有做前端，Python有个Django框架，这个框架就是基于服务端渲染的，那个时候用的还是模板引擎替换的方式，替换模板标签，而现代的服务端渲染跟过去的模板标签替换略有些不同"}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"模板引擎替换"}]}],"\n",["$","p",null,{"children":["过去的模板标签形式简单说就是预准备一段html，静态的部分直接写出来，动态可变的部分用",["$","code",null,{"children":"{{ }}或{% %}"}],"等标签标记，内部写上可变的变量，等到执行渲染时，将这些打标记的地方替换成变量对应的值，从而完成整个页面的渲染"]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"现代服务端渲染"}]}],"\n",["$","p",null,{"children":"现代的服务端渲染，不只是简单的模板替换了，现代的项目基于React/vue等工程化项目，要保留通过服务端渲染内容提高性能，同时还要保留现有的工程化能力"}],"\n",["$","p",null,{"children":"相当于要在返回html之前，也就是在打包构建阶段，就对整个工程化项目完成处理，之后在将打包好的内容插入到html并返回"}],"\n",["$","h2",null,{"id":"注水和脱水","children":"注水和脱水"}],"\n",["$","p",null,{"children":"注水（Hydration）是指客户端将服务器返回的静态HTML与JavaScript结合，使其成为可交互的动态页面。脱水（Dehydration）则是服务器在渲染时将应用的状态序列化，嵌入到HTML中，供客户端注水时使用。"}],"\n",["$","p",null,{"children":"脱水（Dehydration）："}],"\n",["$","p",null,{"children":"指在服务端渲染过程中，将组件的状态（State）或数据（Data）序列化（Serialize），嵌入到生成的 HTML 中，传递给客户端，供客户端注水时使用"}],"\n",["$","h3",null,{"id":"简版流程","children":"简版流程"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"服务端脱水："}],"\n"]}],"\n",["$","p",null,{"children":"渲染组件 → 获取数据 → 序列化状态 → 嵌入 HTML。"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"客户端注水："}],"\n"]}],"\n",["$","p",null,{"children":"加载 HTML → 解析初始状态 → 初始化应用 → 激活交互。"}],"\n",["$","h3",null,{"id":"作用","children":"作用"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"避免客户端重复请求数据。"}],"\n",["$","li",null,{"children":"确保服务端和客户端初始状态一致。"}],"\n"]}],"\n",["$","h3",null,{"id":"实现","children":"实现"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"服务端渲染组件时，会执行数据获取逻辑（如 API 请求），生成最终状态。"}],"\n",["$","li",null,{"children":"将这些状态序列化为字符串（如 JSON），通过 script 标签注入到 HTML 中"}],"\n"]}],"\n",["$","p",null,{"children":"react为例，官方提供的方法"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"服务端：renderToString"}],"\n",["$","li",null,{"children":"客户端：hydrateRoot"}],"\n"]}],"\n",["$","h2",null,{"id":"从0开始设计一个极简ssr项目","children":"从0开始设计一个极简SSR项目"}],"\n",["$","p",null,{"children":["$","a",null,{"href":"https://github.com/miaolin1993/interview-question/tree/master/%E6%9E%81%E7%AE%80%E7%89%88%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93,","title":"项目地址","children":"极简项目地址"}]}],"\n",["$","p",null,{"children":"这里展示部分代码"}],"\n",["$","p",null,{"children":"服务端渲染组件, 依赖renderToString方法，脱水处理"}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"import React from 'react'\r\nimport { renderToString } from 'react-dom/server'\r\nimport Test from './test.jsx'\r\n\r\nexport function render() {\r\n    return renderToString(<Test />)\r\n}\n"}]}],"\n",["$","p",null,{"children":"客户端注水，依赖hydrateRoot"}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"import React from 'react'\r\nimport { hydrateRoot } from 'react-dom/client'\r\nimport Test from './test.jsx'\r\n\r\nhydrateRoot(document.getElementById('app'), <Test />)\n"}]}],"\n",["$","p",null,{"children":"html模板"}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"<body>\r\n  测试服务端渲染\r\n  <div id=\"app\">\r\n    <!-- 替换react代码 -->\r\n  </div>\r\n  <script type=\"module\" src=\"/main.jsx\"></script>\r\n</body>\n"}]}],"\n",["$","p",null,{"children":"最终渲染融合挂载"}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"app.use('*', async (req, res) => {\r\n    // 使用vite进行模板渲染\r\n    const template = await vite.transformIndexHtml(req.url, fs.readFileSync('index.html', 'utf-8'))\r\n    // 用vite进行组件渲染\r\n    const { render } = await vite.ssrLoadModule(\"render.jsx\")\r\n    // 将react组件挂载到模板\r\n    const reactHtml = render()\r\n    const html = template.replace('<!-- 替换react代码 -->', reactHtml)\r\n    // 渲染并返回最终模板\r\n    res.send(html)\r\n})\n"}]}],"\n",["$","p",null,{"children":"这样就实现了前面说的在返回html前完成react的打包渲染，并嵌入到html，从而完成了一个最基本的服务端渲染过程"}]]
